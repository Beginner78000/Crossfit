-- Deploy crossfit:crossfit_V1 to pg
BEGIN;

CREATE TABLE "category" (
    "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "label" TEXT NOT NULL UNIQUE
);

CREATE TABLE "movement" (
    "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "name" TEXT NOT NULL UNIQUE,
    "type" TEXT,
    "description" TEXT NOT NULL,
    "visual_name" VARCHAR(64) NOT NULL UNIQUE,
    "movement_url" VARCHAR(255) NOT NULL UNIQUE,
    "category_id" INT NOT NULL REFERENCES "category"("id")
);

CREATE TABLE "training" (
    "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "type" TEXT,
    "title" VARCHAR(100) NOT NULL UNIQUE,
    "mobility" TEXT ARRAY NOT NULL,
    "warm_up" TEXT ARRAY NOT NULL,
    "skills" TEXT ARRAY NOT NULL,
    "workout" TEXT ARRAY NOT NULL,
    "category_id" INT NOT NULL REFERENCES "category"("id")
);

CREATE TABLE "box" (
    "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "name" TEXT NOT NULL UNIQUE,
    "type" TEXT,
    "email" TEXT UNIQUE,
    "phone_number" VARCHAR(15) NOT NULL UNIQUE,
    "website" TEXT NOT NULL UNIQUE,
    "zip_code" INT NOT NULL,
    "city" TEXT NOT NULL,
    "category_id" INT NOT NULL REFERENCES "category"("id")
);

COMMIT;